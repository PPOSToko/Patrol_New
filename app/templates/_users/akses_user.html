<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="./assets/img/favicon.png">
    <title>Q-Patrol</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <link href="https://cdn.jsdelivr.net/npm/smartwizard@6/dist/css/smart_wizard_all.min.css"  rel="stylesheet"  type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700" />
    <link href="./assets/css/nucleo-icons.css" rel="stylesheet" />
    <link href="./assets/css/nucleo-svg.css" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <!-- CSS Files -->
    <link id="pagestyle" href="{{ url_for('static', filename='css/material-dashboard.css') }}"  rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/smartwizard@6/dist/js/jquery.smartWizard.min.js" type="text/javascript" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.min.js"></script>
    <script type="text/javascript"   src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.5.2/bootbox.min.js"></script>
    <style>   table,tr {  border: 1px solid;  }  </style>
  </head>
  <body class="g-sidenav-show  bg-gray-100">
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur" data-scroll="true">
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
        </nav>
            <ul class="navbar-nav  justify-content-end">
                <li class="nav-item">
                  <a class="nav-link text-white " href="/home">
                      <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                        <i class="material-icons opacity-10 ">home</i>
                        <span class="nav-link-text ms-1">Home</span>
                      </div>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-white " href="/logout">
                      <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                        <i class="material-icons opacity-10">logout</i>
                        <span class="nav-link-text ms-1">Sign Out</span>
                      </div>
                  </a>
                </li>
            </ul>
      </div>
    </nav>     
      <!-- isi menu -->
    <div class ="mask gradient-custom"></div>
    <div class="col-12">
      <div class="card my-4">
        <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2" >
          <div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
            <h6 class="text-white text-capitalize ps-3">Access Configuration</h6>
          </div>
        </div>
        <div class="card-body px-0 pb-2 ">
          <center><div class="col-md-6" style="padding-left:10px; margin:auto;"> 
            <label class="form-label">Jabatan</label>
            <div class="input-group input-group-outline">
              <select class="form-control mb-3"  id="jabatan" onchange="cekakses();">
                <option value=""></option>  
                <option value="1">Inspector</option>
                <option value="2">Admin</option>
                <option value="3">Developer</option>
                </select>
            </div>
          </div>
          <script>
            function cekakses(){
              var jabatan = $('#jabatan').val();
              $.ajax({
                    type    : 'POST',
                    url     : '/cekaksesuser',
                    dataType: 'json',
                    data    : {
                        'level':jabatan
                    },
                    success : function(response){
                        waitingDialog.hide();
                        if(response.status=='1'){
                           if (response.mn01 == "V") {
                             document.getElementById("mn01").checked = true;
                           }else{
                              document.getElementById("mn01").checked = false;
                           }
                           if (response.mn01 == "V") {
                             document.getElementById("mn01").checked = true;
                           }else{
                            document.getElementById("mn01").checked = false;
                           }
                           if (response.mn02 == "V") {
                             document.getElementById("mn02").checked = true;
                           }else{
                            document.getElementById("mn02").checked = false;
                           }
                           if (response.mn03 == "V") {
                             document.getElementById("mn03").checked = true;
                           }else{
                            document.getElementById("mn03").checked = false;
                           }
                           if (response.mn04 == "V") {
                             document.getElementById("mn04").checked = true;
                           }else{
                            document.getElementById("mn04").checked = false;
                           }
                           if (response.mn05 == "V") {
                             document.getElementById("mn05").checked = true;
                           }else{
                            document.getElementById("mn05").checked = false;
                           }
                           if (response.mn06 == "V") {
                             document.getElementById("mn06").checked = true;
                           }else{
                            document.getElementById("mn06").checked = false;
                           }
                           if (response.mn07 == "V") {
                             document.getElementById("mn07").checked = true;
                           }else{
                             document.getElementById("mn07").checked = false;
                           }
                           if (response.mn08 == "V") {
                             document.getElementById("mn08").checked = true;
                           }else{
                             document.getElementById("mn08").checked = false;
                           }
                           if (response.mn09 == "V") {
                             document.getElementById("mn09").checked = true;
                           }else{
                            document.getElementById("mn09").checked = false;
                           }

                        }

                    },
                    error: function(error){
                        console.log(error);
                        waitingDialog.hide();
                        if(error.status == 403){
                            msg_server_reloading();
                        }else{
                            msg_alert_warning('Data gagal diproses !', '#lama');
                        }
                    }
                })
              

            }
          </script>
          <div class="table-responsive p-0">
            <div style="overflow-x:auto; display:flex; padding-left: 10px; padding-right: 10px;">
              <table class="table table-sm padding-x-xs ">
                <tr>
                  <th >Page</th>
                  <th>Grant Access</th>
                </tr>
                <tr>
                    <td>Manage Data</td>
                    <td>
                      <div class="form-check">
                        <input class="form-check-input" type="" id="manage" name="manage" > 
                      </div>
                    </td>
                </tr>
                <tr>
                    <td>Question</td>
                    <td>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="mn01" name="mn01"> 
                      </div>
                    </td>
                </tr>
                <tr>
                  <td>Manage Induk</td>
                  <td>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="mn02" name="mn02"> 
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>Manage Point</td>
                  <td>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="mn03" name="manage_point"> 
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>Start New Patrol</td>
                  <td>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="mn04" name="start" > 
                    </div>
                  </td>
                </tr>
                <tr>
                    <td>Continue unfinished patrol</td>
                    <td>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="mn05" name="continue" > 
                      </div>
                    </td>
                </tr>
              </table>
              <table class="table table-sm px-2">
                  <tr>
                    <th >Page</th>
                    <th>Grant Access</th>
                  </tr>
                  <tr>
                    <td>Review patrol</td>
                    <td>
                      <div class="form-check">
                        <input class="form-check-input" type="text" name="review" > 
                      </div>
                    </td>
                  </tr>
                  <tr>
                      <td>View Patrol Detail</td>
                      <td>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="mn06" name="view_patrol"> 
                        </div>
                      </td>
                  </tr>
                  <tr>
                    <td>Settings</td>
                    <td>
                      <div class="form-check">
                        <input class="form-check-input" type="text" name="settings"> 
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td>Create Employee</td>
                    <td>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="mn07" name="employee"> 
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td>Akses User</td>
                    <td>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="mn08" name="akses_user"> 
                      </div>
                    </td>
                  </tr>
                <tr>
                  <td>Change Password</td>
                  <td>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="mn09" name="change_password" > 
                    </div>
                  </td>
                </tr>
                <tr>
                
              </table>   
            </div>
          </div>
        </div>
    <div class="col-md-6">
      <div class="col-md-4 text-right" style="padding-left: 10px;">
        <a href="#" class="btn btn-primary btn-lg active" role="button" onclick="save()" aria-pressed="true">Save</a>
        </a>
        <a href="/home" class="btn btn-primary btn-lg active" role="button" aria-pressed="true">Cancel</a>
      </a>
      </div>
    </div>
      </div>
      <footer class="footer">
        <div class="container-fluid">
          <div class="row align-items-center justify-content-lg-between">
            <div class="col-lg-12mb-lg-0 mb-4">
              <div class="copyright text-center text-sm text-muted text-shadow">
                <center><a href="http://192.168.30.3/support/" class="font-weight-bold" target="_blank" style="color: rgb(0, 0, 0);">Copyright ©IT - PT.Cahayajakarta @2022</a></center>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>
    <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/jquery-ui.js') }}"></script>
    <script src="{{ url_for('static', filename='js/core/popper.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/core/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/perfect-scrollbar.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/smooth-scrollbar.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/chartjs.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootbox.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/funct.js') }}"></script>
    <script src="{{ url_for('static', filename='js/create.js') }}"></script>
    <script src="{{ url_for('static', filename='js/search.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.md5.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/datatables/jquery.dataTables.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/datatables/dataTables.colVis.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/datatables/dataTables.tableTools.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/datatables/dataTables.bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/pace/pace.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/jquery-validate/jquery.validate.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plugins/masked-input/jquery.maskedinput.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.min.js') }}"></script>
    <script>
        function save(){
          var jabatan = $('#jabatan').val();
          var mn01 = $('#mn01').is(':checked'),mn02 = $('#mn02').is(':checked'),mn03 = $('#mn03').is(':checked'),
          mn04= $('#mn04').is(':checked'),mn05= $('#mn05').is(':checked'),mn06= $('#mn06').is(':checked'),
          mn07= $('#mn07').is(':checked'),mn08= $('#mn08').is(':checked'),mn09= $('#mn09').is(':checked'),
          mn10= false,mn11=false,mn12=false,mn13=false,mn14=false;
          // mn12= $('#mn12').is(':checked'),mn13 = $('#mn013').is(':checked'),mn14 = $('#mn014').is(':checked');
          if (jabatan==''){
            bootbox.alert('Level User harus dpilih !!');
          }else{

            bootbox.confirm({
                      message: "Simpan Akses User ?",
                      buttons: {
                          confirm: {
                              label: 'Yes',
                              className: 'btn-success'
                          },
                          cancel: {
                              label: 'No',
                              className: 'btn-danger'
                          }
                      },
                      callback: function (result) {
                          // console.log('This was logged in the callback: ' + result);
                          if(result){
                            $.ajax({
                                type    : 'POST',
                                url     : '/simpanaksesuser',
                                dataType: 'json',
                                data    : {
                                    'jabatan':jabatan,'mn01':mn01,'mn02':mn02,'mn03':mn03,'mn04':mn04,'mn05':mn05,'mn06':mn06,'mn07':mn07,'mn08':mn08,'mn09':mn09,'mn10':mn10,'mn11':mn11,'mn12':mn12,'mn13':mn13,'mn14':mn14
                                },
                                success : function(response){
                                    waitingDialog.hide();
                                    if(response.status=='1'){
                                        var msg = "<h6><i class='fa fa-info-circle text-primary'></i>&nbsp;"+response.msg+"</h6>";
                                        var box = bootbox.alert(msg);
                                        box.on('hidden.bs.modal', function(){
                                            document.location.href = "/home";
                                        });
                                    }else{
                                        msg_alert_warning(response.msg, '#lama');
                                    }
                                },
                                error: function(error){
                                    console.log(error);
                                    waitingDialog.hide();
                                    if(error.status == 403){
                                        msg_server_reloading();
                                    }else{
                                        msg_alert_warning('Data gagal diproses !', '#lama');
                                    }
                                }
                            })
                          }

                      }
                  });        

          }
        };
    </script>

  </body>

</html>
